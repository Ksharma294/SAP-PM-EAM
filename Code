Public Sub Testing()

 ' Declare necessary objects
    Dim SapGuiAuto As Object
    Dim application As Object
    Dim connection As Object
    Dim session As Object
    Dim x As Integer
    Dim Ws As Worksheet
    Dim timeValue As String
    
    
    
  
' Get the SAP GUI Scripting Engine
    Set SapGuiAuto = GetObject("SAPGUI")
    Set application = SapGuiAuto.GetScriptingEngine

    ' Access the first connection and session
    Set connection = application.Children(0)
    Set session = connection.Children(0)
    Set Ws = ThisWorkbook.ActiveSheet
  

session.FindById("wnd[0]/tbar[0]/okcd").Text = "ik11"
session.FindById("wnd[0]").SendVKey 0
session.FindById("wnd[0]/usr/ctxtIMRG-POINT").Text = "9001"
session.FindById("wnd[0]/usr/ctxtRIMR0-DFDAT").Text = "24.09.2024"
session.FindById("wnd[0]/usr/ctxtRIMR0-DFTIM").Text = "04:08:27"
session.FindById("wnd[0]/usr/txtRIMR0-DFRDR").Text = "IDADMIN"
session.FindById("wnd[0]/usr/txtRIMR0-DFRDR").SetFocus
session.FindById("wnd[0]/usr/txtRIMR0-DFRDR").caretPosition = 7
session.FindById("wnd[0]").SendVKey 0
session.FindById("wnd[0]/usr/txtRIMR0-CNTRC").Text = "+______1000___________"
session.FindById("wnd[0]/usr/txtRIMR0-CNTRC").caretPosition = 10
session.FindById("wnd[0]").SendVKey 0

session.FindById("wnd[0]/usr/ctxtIMRG-VLCOD").SetFocus
session.FindById("wnd[0]/usr/ctxtIMRG-VLCOD").caretPosition = 0
session.FindById("wnd[0]").SendVKey 4
session.FindById("wnd[1]/usr/cntlTREE_CONTROL_AREA/shellcont/shell").SelectedNode = "          3"
session.FindById("wnd[1]/usr/cntlTREE_CONTROL_AREA/shellcont/shell").DoubleClickNode "          3"




session.FindById("wnd[0]/usr/txtIMRG-MDTXT").Text = "PumP is running Good"
session.FindById("wnd[0]/usr/ctxtIMRG-PREST").SetFocus
session.FindById("wnd[0]/usr/ctxtIMRG-PREST").caretPosition = 0
session.FindById("wnd[0]").SendVKey 4
session.FindById("wnd[1]/usr/sub/1[0,0]/sub/1/2[0,0]/sub/1/2/4[0,4]/lbl[1,4]").SetFocus
session.FindById("wnd[1]/usr/sub/1[0,0]/sub/1/2[0,0]/sub/1/2/4[0,4]/lbl[1,4]").caretPosition = 0
session.FindById("wnd[1]").SendVKey 2
session.FindById("wnd[0]/tbar[0]/btn[11]").Press
session.FindById("wnd[0]/tbar[0]/btn[3]").Press


End Sub




Public Sub FetchMeasureDocument()

    Dim SapGuiAuto As Object
    Dim application As Object
    Dim connection As Object
    Dim session As Object
    Dim x As Integer
    Dim Ws As Worksheet
    Dim timeValue As String
    
'Get the SAP GUI Scripting Engine
    Set SapGuiAuto = GetObject("SAPGUI")
    Set application = SapGuiAuto.GetScriptingEngine

    ' Access the first connection and session
    Set connection = application.Children(0)
    Set session = connection.Children(0)
    Set Ws = ThisWorkbook.ActiveSheet
  
   'Initialize the variable x
    x = 2 ' Start from the first row

    ' Get the SAP GUI Scripting Engine
    Set SapGuiAuto = GetObject("SAPGUI")
    Set application = SapGuiAuto.GetScriptingEngine

    ' Access the first connection and session
    Set connection = application.Children(0)
    Set session = connection.Children(0)
    
      Do While x < 5

If Not IsObject(application) Then
   Set SapGuiAuto = GetObject("SAPGUI")
   Set application = SapGuiAuto.GetScriptingEngine
End If
If Not IsObject(connection) Then
   Set connection = application.Children(0)
End If
If Not IsObject(session) Then
   Set session = connection.Children(0)
End If
If IsObject(WScript) Then
   WScript.ConnectObject session, "on"
   WScript.ConnectObject application, "on"
End If


session.FindById("wnd[0]").Maximize
session.FindById("wnd[0]/tbar[0]/okcd").Text = "/nse16n"
session.FindById("wnd[0]").SendVKey 0
session.FindById("wnd[0]/usr/ctxtGD-TAB").Text = "imrg"
session.FindById("wnd[0]/usr/ctxtGD-TAB").caretPosition = 4
session.FindById("wnd[0]").SendVKey 0

session.FindById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,2]").Text = Ws.Cells(x, 1).Value

session.FindById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,3]").Text = Ws.Cells(x, 2).Value

timeValue = Format(Ws.Cells(x, 3).Value, "hh:mm:ss")
session.FindById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,4]").Text = timeValue

session.FindById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,4]").SetFocus
session.FindById("wnd[0]/usr/tblSAPLSE16NSELFIELDS_TC/ctxtGS_SELFIELDS-LOW[2,4]").caretPosition = 8
session.FindById("wnd[0]").SendVKey 0
session.FindById("wnd[0]/tbar[1]/btn[8]").Press
session.FindById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell").SetCurrentCell -1, ""




Set myGrid = session.FindById("wnd[0]/usr/cntlRESULT_LIST/shellcont/shell")
allRows = myGrid.RowCount - 1 'number of SAP rows
allCols = myGrid.ColumnCount - 1 'number of SAP Columns
Dim columns As Object
Set columns = myGrid.ColumnOrder 'SAP column names in order in SAP window


  For j = 0 To allRows
 myGrid.FirstVisibleRow = j
  For i = 0 To 0
   ActiveSheet.Cells(x, i + 6).Value = myGrid.GetCellValue(j, columns(i)) 'starts in cell "A1"
  Next i
 Next j


session.FindById("wnd[0]/tbar[0]/btn[3]").Press
session.FindById("wnd[0]/tbar[0]/btn[3]").Press




x = x + 1
Loop
End Sub
